(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Extra"],{"07d7":function(e,t,r){"use strict";r("0bd3")},"0bd3":function(e,t,r){},"0d2a":function(e,t,r){"use strict";r("9477")},1782:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("aside",{staticClass:"order-form__aside"},[r("p",{staticClass:"aside__order"},[e._v(e._s(e.$translate("orderForm.aside.order")))]),e._l(e.orderItems,(function(t,a){return[t?r("div",{key:a,staticClass:"aside__item"},[r("span",[e._v(e._s(e.$translate("orderForm.aside."+a)))]),r("span"),"rent"===a?r("span",[e.getDaysCount(t.from,t.to)?[e._v(" "+e._s(e.getDaysCount(t.from,t.to))+" д ")]:e._e(),e.getHoursCount(t.from,t.to)?[e._v(" "+e._s(e.getHoursCount(t.from,t.to))+" ч ")]:e._e()],2):r("span",[e._v(e._s(t))])]):e._e()]})),e.price&&!e.loading?r("div",{staticClass:"aside__amount"},[r("span",[e._v(e._s(e.$translate("orderForm.aside.price")))]),r("span",[e._v(e._s(e.price)+" ₽")])]):e.loading?r("i",{staticClass:"el-icon-loading",staticStyle:{margin:"10px auto"}}):e._e(),r("el-button",{class:[e.isFinishOrder?"aside__amount-finish-btn":""],attrs:{type:"success",disabled:e.isDisabled},on:{click:e.getNextStep}},[e._v(" "+e._s(e.$translate("orderForm.aside."+e.getLocaleKey(e.$route.name)))+" ")])],2)},n=[],o=r("a6f4"),i={name:"OrderAside",props:{orderItems:{type:Object,default:function(){return{}}},isDisabled:{type:Boolean,default:!0},price:{type:String|Number,default:null},loading:{type:Boolean,default:!1}},setup:function(e,t){var r=t.emit,a=t.root,n=Object(o["a"])((function(){return a.$route.path.includes("confirm-order")})),i={location:"chooseModel",model:"extra",extra:"amountOptions",amount:"buy",confirm:"cancel"},c=function(e){return i[e.toLowerCase()]};function s(){n.value?r("cancel"):r("next")}return{getNextStep:s,isFinishOrder:n,getLocaleKey:c}},methods:{getDaysCount:function(e,t){var r=new Date(t)-new Date(e);return r?Math.floor(+r/1e3/60/60/24):0},getHoursCount:function(e,t){return new Date(t).getHours()-new Date(e).getHours()}}},c=i,s=(r("cde1"),r("2877")),l=Object(s["a"])(c,a,n,!1,null,"71fbfa41",null);t["a"]=l.exports},2891:function(e,t,r){},"77e3":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var a=r("a6f4"),n=Object(a["f"])({orderStatusId:"607069ad2aed9a0b9b7e5530",cityId:"",pointId:"",carId:{},color:"",dateFrom:0,dateTo:0,rateId:{},price:0,isFullTank:!1,isNeedChildChair:!1,isRightWheel:!1});function o(e){for(var t in e)e.hasOwnProperty(t)&&(n.value[t]=e[t])}function i(){return{configItems:n,updateConfigFields:o}}},9477:function(e,t,r){},"9a74":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-radio-group",{on:{change:e.updateFilters},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},[e._l(e.carFilterData,(function(t,a){return[t.name?r("el-radio",{key:a,attrs:{label:t.id},on:{change:function(r){return e.changeValue(t)}}},[e._v(" "+e._s(t.name)+" ")]):r("el-radio",{key:a,attrs:{label:t},on:{change:function(r){return e.changeValue(t)}}},[e._v(" "+e._s(t)+" ")])]}))],2)},n=[],o=r("a6f4"),i={name:"RadioGroup",props:{carFilterData:{type:Array,required:!0},modelData:{type:String|Object,required:!0}},setup:function(e){var t=Object(o["g"])(e),r=t.modelData,a=Object(o["f"])("");return Object(o["h"])(r,(function(e){return a.value=e})),{model:a}},methods:{changeValue:function(e){this.$emit("change",e)},updateFilters:function(e){this.$emit("update:modelData",e)}}},c=i,s=(r("9e7a"),r("2877")),l=Object(s["a"])(c,a,n,!1,null,"aee6fec4",null);t["a"]=l.exports},"9e7a":function(e,t,r){"use strict";r("2891")},b1f5:function(e,t,r){},cde1:function(e,t,r){"use strict";r("b1f5")},d6a5:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"extra"},[r("div",{staticClass:"extra__wrapper"},[r("div",{staticClass:"extra__color"},[r("p",[e._v(e._s(e.$translate("orderForm.content.extra.color")))]),r("radio-group",{attrs:{"model-data":e.extraState.colorFilter,"car-filter-data":e.extraState.colorModel},on:{"update:modelData":function(t){return e.$set(e.extraState,"colorFilter",t)},"update:model-data":function(t){return e.$set(e.extraState,"colorFilter",t)},change:e.selectColor}})],1),r("div",{staticClass:"extra__picker"},[r("p",[e._v(e._s(e.$translate("orderForm.content.extra.date")))]),r("div",[r("span",[e._v(e._s(e.$translate("orderForm.content.extra.from")))]),r("el-date-picker",{attrs:{type:"datetime",editable:"","clear-icon":"el-icon-close",clearable:!0,placeholder:e.translate("orderForm.content.extra.placeholder"),"picker-options":e.extraState.pickerOptionsFrom,format:"dd-MM-yyyy HH:mm"},model:{value:e.extraState.from,callback:function(t){e.$set(e.extraState,"from",t)},expression:"extraState.from"}})],1),r("div",[r("span",[e._v(e._s(e.$translate("orderForm.content.extra.to")))]),r("el-date-picker",{attrs:{type:"datetime",editable:"","clear-icon":"el-icon-close",clearable:!0,"picker-options":e.extraState.pickerOptionsTo,placeholder:e.translate("orderForm.content.extra.placeholder"),format:"dd-MM-yyyy HH:mm"},model:{value:e.extraState.to,callback:function(t){e.$set(e.extraState,"to",t)},expression:"extraState.to"}})],1)]),r("div",{staticClass:"extra__tariff"},[r("p",[e._v(e._s(e.$translate("orderForm.content.extra.tariff")))]),r("radio-group",{attrs:{"model-data":e.extraState.tariffFilter,"car-filter-data":e.extraState.tariffModel},on:{"update:modelData":function(t){return e.$set(e.extraState,"tariffFilter",t)},"update:model-data":function(t){return e.$set(e.extraState,"tariffFilter",t)},change:e.addTariff}})],1),r("div",{staticClass:"extra__options"},[r("p",[e._v(e._s(e.$translate("orderForm.content.extra.extraOpts")))]),r("checkbox-group",{attrs:{"checkbox-filter-data":e.extraOptionsData,"checkbox-model-data":e.extraState.extraOptions},on:{"update:checkboxModelData":function(t){return e.$set(e.extraState,"extraOptions",t)},"update:checkbox-model-data":function(t){return e.$set(e.extraState,"extraOptions",t)},change:e.addExtraOptions}})],1)]),r("order-aside",{attrs:{"order-items":e.orderItems,"is-disabled":e.isDisabledButton,price:e.priceRange,loading:e.extraState.isLoading},on:{next:e.updateCurrentOrder}})],1)},n=[],o=r("a6f4"),i=r("9a74"),c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-checkbox-group",{on:{change:e.updateFilters},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},[e._l(e.checkboxFilterData,(function(t,a){return[t.name?r("el-checkbox",{key:a,attrs:{label:t.name},on:{change:function(r){return e.changeValue(t,a)}}},[e._v(" "+e._s(e.$translate("checkboxGroup."+t.name))+" ")]):r("el-checkbox",{key:a,attrs:{label:t},on:{change:function(r){return e.changeValue(t,a)}}},[e._v(" "+e._s(e.$translate("checkboxGroup."+t))+" ")])]}))],2)},s=[],l={name:"CheckboxGroup",props:{checkboxFilterData:{type:Array,required:!0},checkboxModelData:{type:Array,required:!0}},setup:function(e){var t=Object(o["g"])(e),r=t.checkboxModelData,a=Object(o["f"])([]);return Object(o["h"])(r,(function(e){return a.value=e})),{model:a}},methods:{changeValue:function(e,t){this.$emit("change",{item:e,index:t})},updateFilters:function(e){this.$emit("update:checkboxModelData",e)}}},u=l,d=(r("07d7"),r("2877")),f=Object(d["a"])(u,c,s,!1,null,"4f41eaa1",null),p=f.exports,h=r("1782"),m=r("9923"),v=r("365c"),x=r("5c96"),b=r("77e3");function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e){return w(e)||k(e)||S(e)||D()}function D(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function S(e,t){if(e){if("string"===typeof e)return F(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?F(e,t):void 0}}function k(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function w(e){if(Array.isArray(e))return F(e)}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function j(e,t,r,a,n,o,i){try{var c=e[o](i),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(a,n)}function C(e){return function(){var t=this,r=arguments;return new Promise((function(a,n){var o=e.apply(t,r);function i(e){j(o,a,n,i,c,"next",e)}function c(e){j(o,a,n,i,c,"throw",e)}i(void 0)}))}}var I=Object(b["a"])(),M=I.configItems,$=I.updateConfigFields,P={name:"Extra",components:{RadioGroup:i["a"],CheckboxGroup:p,OrderAside:h["a"]},setup:function(e,t){var r=t.root,a=Object(m["b"])(),n=a.translate,i=Object(o["e"])({colorFilter:"",colorModel:[],tariffFilter:"",tariffModel:[],extraOptions:[],extraOptionsData:[],from:new Date,to:new Date,priceMin:"",priceMax:"",extraPrice:0,pickerOptionsFrom:{disabledDate:function(e){return e>new Date}},pickerOptionsTo:{disabledDate:function(e){return e<new Date}},isLoading:!0}),c=Object(o["a"])((function(){return{to:i.to,from:i.from}})),s=Object(o["f"])({city:"",model:"",color:"",rent:c,tariff:"",child:"",rightDrive:"",full:""}),l=[{name:"На сутки, 1999 ₽/сутки",value:"day"},{name:"Поминутно, 7₽/мин",value:"minute"}],u=[{name:"full",value:500},{name:"child",value:200},{name:"rightDrive",value:1600}],d=r.$route.query.id,f=Object(o["f"])({}),p=Object(o["f"])(0);function h(e){var t=[];return e.forEach((function(e){e.isFullTank?t.push("full"):e.isNeedChildChair?t.push("child"):e.isRightWheel&&t.push("rightDrive")})),t}function b(){return g.apply(this,arguments)}function g(){return g=C(regeneratorRuntime.mark((function e(){var t,r,a,n,o,c,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(v["f"])(d);case 3:c=e.sent,l=c.data,$(l.data),f.value=l.data,i.priceMin=M.value.carId.priceMin,i.priceMax=M.value.carId.priceMax,i.to=M.value.dateTo?M.value.dateTo:new Date,i.from=M.value.dateFrom?M.value.dateFrom:new Date,i.colorFilter=M.value.color?M.value.color:"Любой",i.tariffFilter=(null===(t=M.value.rateId)||void 0===t?void 0:t.id)||"",(r=i.extraOptions).push.apply(r,_(h([{isFullTank:M.value.isFullTank},{isNeedChildChair:M.value.isNeedChildChair},{isRightWheel:M.value.isRightWheel}]))),s.value.city="".concat(M.value.cityId.name,", ").concat(M.value.pointId.address),s.value.model=M.value.carId.name,s.value.color=M.value.color?M.value.color:"Любой",s.value.tariff=(null===(a=M.value.rateId)||void 0===a||null===(n=a.rateTypeId)||void 0===n?void 0:n.name)||"",M.value.carId.colors.length?(o=i.colorModel).push.apply(o,_(M.value.carId.colors)):i.colorModel.push("Любой"),p.value=M.value.carId.priceMin,e.next=25;break;case 22:e.prev=22,e.t0=e["catch"](0),x["Notification"].error({message:e.t0});case 25:case"end":return e.stop()}}),e,null,[[0,22]])}))),g.apply(this,arguments)}function O(){return D.apply(this,arguments)}function D(){return D=C(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(v["h"])();case 3:t=e.sent,r=t.data,i.tariffModel=r.data.map((function(e){var t=e.rateTypeId,r=t.id,a=t.unit,n=t.name;return y(y({},e),{},{rateTypeId:r,name:n,unit:a})})),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),x["Notification"].error({message:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),D.apply(this,arguments)}return Object(o["d"])((function(){return Promise.all([O(),b()]).then((function(){return i.isLoading=!1}))})),{extraState:i,tariffModel:l,extraOptionsData:u,translate:n,orderItems:s,priceRange:p,currentOrder:f,orderId:d,configItems:M}},computed:{isRentAccepted:function(){var e=new Date(this.extraState.to).getDate(),t=new Date(this.extraState.to).getMonth(),r=new Date(this.extraState.to).getHours(),a=new Date(this.extraState.to).getMinutes(),n=new Date(this.extraState.from).getDate(),o=new Date(this.extraState.from).getMonth(),i=new Date(this.extraState.from).getHours(),c=new Date(this.extraState.from).getMinutes();return e===n&&t===o&&r===i&&a===c},isDisabledButton:function(){return Boolean(!this.orderItems.color||this.isRentAccepted||!this.orderItems.tariff)}},methods:{selectColor:function(e){this.orderItems.color=e},addExtraOptions:function(e){var t=e.item;this.orderItems[t.name]?(this.orderItems[t.name]="",this.getPriceWithExtraOptions(-t.value)):(this.orderItems[t.name]="Да",this.getPriceWithExtraOptions(t.value))},getPriceWithExtraOptions:function(e){this.extraState.extraPrice+=e,this.priceRange+=e},addTariff:function(e){this.orderItems.tariff=e.name,this.priceRange=this.getPriceByTariff(e,this.extraState.priceMin)+this.extraState.extraPrice},getPriceByTariff:function(e,t){var r=new Date(this.extraState.to)-new Date(this.extraState.from);if("сутки"===e.unit){var a=r?Math.floor(7*(+r/1e3/60/60-24)*60):0;return t+e.price+a}return"мин"===e.unit?Math.floor(+r/1e3/60/60)*e.price*60+t:"7 дней"===e.unit?t+e.price:void 0},updateCurrentOrder:function(){var e=this,t=this.$route.query.id,r=y(y({},M.value),{},{color:this.extraState.colorFilter,dateFrom:+this.extraState.from,dateTo:+this.extraState.to,rateId:this.extraState.tariffModel.filter((function(t){return t.id===e.extraState.tariffFilter}))[0],price:this.priceRange,isFullTank:this.extraState.extraOptions.includes("full"),isNeedChildChair:this.extraState.extraOptions.includes("child"),isRightWheel:this.extraState.extraOptions.includes("rightDrive")});try{Object(v["i"])(t,r),this.$router.push({name:"Amount",query:{id:t}})}catch(a){x["Notification"].error({message:a})}}}},T=P,R=(r("0d2a"),Object(d["a"])(T,a,n,!1,null,"5639d830",null));t["default"]=R.exports}}]);
//# sourceMappingURL=Extra.88b7560e.js.map